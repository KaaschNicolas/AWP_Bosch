<Page
    x:Class="App.Views.PcbSinglePage"
	x:Name="PcbSinglePageContent"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behaviors="using:App.Behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:in="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls" 
	xmlns:viewModels="using:App.ViewModels"
    xmlns:local="using:App.Views" 
    xmlns:converters="using:CommunityToolkit.WinUI.UI.Converters"
    mc:Ignorable="d">

    <!--<Page.Resources> <DataTemplate x:Key="TransfersPageTemplate"> <local:TransfersPage/> </DataTemplate> </Page.Resources>-->
    
    <behaviors:NavigationViewHeaderBehavior.HeaderTemplate>
		<DataTemplate x:DataType="viewModels:PcbSingleViewModel">
            <Grid x:Name="uiElementGrid1" Margin="0,0,50,0">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="2*"/>
					<ColumnDefinition Width="2,5*"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions> 

				<StackPanel
					Grid.Column="0"
					Orientation="Horizontal"
					HorizontalAlignment="Left">
					<CommandBar
						Background="Transparent"
						IsOpen="False"
						DefaultLabelPosition="Right">
						<CommandBar.Content >
							<TextBlock Text="Leiterplatte"/>
						</CommandBar.Content>
					</CommandBar>
					<!--<TextBlock Text="{ x:Bind Path=ViewModel.SerialNumber, Mode=TwoWay }" FontWeight="Bold"/>-->
				</StackPanel>
				<CommandBar
					Grid.Column="1"
					Background="Transparent"
					IsOpen="False"
					DefaultLabelPosition="Right"
					HorizontalAlignment="Center">
					<AppBarButton
					    Icon="Print"
						Label="Drucken"
                        Click="OnPrintButtonClicked"/>
				</CommandBar>
				<StackPanel
                    Grid.Column="2"
					Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right">
					<CommandBar
                        DefaultLabelPosition="Right">
						<AppBarButton
                            Icon="Edit"
                            Label="Bearbeiten"/>
						<AppBarButton
                            Icon="Delete"
                            Label="Löschen"/>
					</CommandBar>
				</StackPanel>
			</Grid>
		</DataTemplate>
	</behaviors:NavigationViewHeaderBehavior.HeaderTemplate>


    <ScrollViewer
            VerticalScrollBarVisibility="Hidden" VerticalScrollMode="Enabled">
        <Grid x:Name="ContentArea">
        <Grid.Resources>
            <CornerRadius x:Key="ControlCornerRadius">8</CornerRadius>
            <!--<DataTemplate x:Key="TransfersPageTemplate"> <local:TransfersPage/> </DataTemplate>-->

        </Grid.Resources>
        <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="0,5*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>


        <StackPanel
			Grid.Column="0"
			Grid.Row="0"
			Orientation="Vertical">
            <StackPanel
				Margin="0,0,0,15"
				Orientation="Horizontal">
                <TextBlock FontSize="18"
						   Text="Seriennummer:"/>
                <TextBlock Margin="5,0,0,0" FontWeight="Bold" FontSize="18"
						   Text="{x:Bind Path=ViewModel.SerialNumber, Mode=TwoWay}"/>
            </StackPanel>
            <StackPanel
				Margin="0,15,0,0"
				Orientation="Horizontal"
				VerticalAlignment="Center">
                <TextBlock
					Margin="0,5,0,0"
					Text="Ausgefallen am:" />
                    <CalendarDatePicker
					x:Name="dateOfFailure"
					Margin="5,0,25,0"
					VerticalAlignment="Top"
					PlaceholderText="Pick a date"
					IsHitTestVisible="false"/>
                    <!--="{x:Bind Path=ViewModel.CreatedDate}"/>-->
                <TextBlock
					Margin="0,5,0,0"
					Text="Aufgenommenen von:"/>
                <TextBlock
					Margin="0,5,0,0"
					Text="Tester_1" FontWeight="Bold"/>
            </StackPanel>
        </StackPanel>
        <InfoBar
				Grid.Column="0"
				Grid.Row="1"
				Grid.ColumnSpan="1"
				HorizontalAlignment="Right"
				IsOpen="True"
				IsIconVisible="True"
				Severity="Warning"
				IsClosable="False"
				Margin="0,0,0,0"
				Title="Einschränkung"
				Message="{x:Bind Path=ViewModel.Restriction.Name, Mode=TwoWay}" />


            <StackPanel
			Grid.Column="0"
			Grid.Row="1"
            Grid.RowSpan="2">
                <StackPanel Margin="0,15,0,0" Orientation="Horizontal">
                    <TextBlock Text="Sachnummer:"/>
                    <TextBlock Text="{x:Bind Path=ViewModel.PcbType, Mode=TwoWay}"/>
                    <!--<TextBlock Margin="5,0,0,0" FontWeight="Bold" Text="1688 400 628 - VCI-Renault mit Display"/>-->
                </StackPanel>
                <StackPanel
				    Margin="0,30,0,0"
				    Orientation="Horizontal">
                    <TextBlock Text="Fehlerkategorie:"/>
                    <TextBlock Text="{x:Bind Path=ViewModel.Diagnose, Mode=TwoWay}"/>
                    <TextBlock Margin="5,0,0,0" FontWeight="Bold"
					Text="Hardware"/>
                </StackPanel>

                <!-- Fehlertypen -->
                <Expander
				Margin="0,20,0,0"
				IsExpanded="True"
				ExpandDirection="Down"
				HorizontalAlignment="Stretch"
				HorizontalContentAlignment="Stretch"
				Header="Fehler: M320"
				Content="Beschreibung: Fehler nicht gefunden"/>
                <Expander
				Margin="0,20,0,0"
				IsExpanded="True"
				ExpandDirection="Down"
				HorizontalAlignment="Stretch"
				HorizontalContentAlignment="Stretch" 
				Header="Fehler: 010"
				Content="Beschreibung: Verbindung herstellen"/>


                <!-- Umlauf-Historie -->
                
                <Grid Margin="0,60,0,0">
                    <Grid.Resources>
                        <converters:StringFormatConverter x:Key="StringFormatConverter"/>
                        <DataTemplate x:Key="RowDetailsTemplate">
                            <StackPanel>
                                <TextBlock Margin="20" Text="Beschreibung:" />
                                <TextBlock Margin="20" Text="{Binding Comment}" />
                            </StackPanel>
                        </DataTemplate>
                    </Grid.Resources>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Text="Umlauf-Historie" VerticalAlignment="Center" Margin="5,0" Style="{ThemeResource SubtitleTextBlockStyle}"/>
                    <controls:DataGrid
      Grid.Row="1"
        x:Name="dataGrid"
        Margin="12"
        VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
        HorizontalScrollBarVisibility="Visible"
        VerticalScrollBarVisibility="Visible"
        AlternatingRowBackground="Transparent"
        AlternatingRowForeground="Gray"
        AreRowDetailsFrozen="False"
        AreRowGroupHeadersFrozen="True"
        AutoGenerateColumns="False"
        CanUserSortColumns="False"
        CanUserReorderColumns="False"
        CanUserResizeColumns="True"
        ColumnHeaderHeight="32"
        MaxColumnWidth="400"
        FrozenColumnCount="0"
        GridLinesVisibility="None"
        HeadersVisibility="Column"
        IsReadOnly="False"
        RowDetailsTemplate="{StaticResource RowDetailsTemplate}"
        RowDetailsVisibilityMode="VisibleWhenSelected"
        SelectionMode="Extended"
        RowGroupHeaderPropertyNameAlternative="Range"
        ItemsSource="{Binding Transfers}"
        SelectedItem="{Binding Transfer, Mode=TwoWay}">
                        <controls:DataGrid.Columns>
                            <controls:DataGridTextColumn Binding="{Binding Id, Mode=TwoWay}" Header="Id" Tag="Id" />
                                <!--<controls:datagridtemplatecolumn.celltemplate>
                                    <datatemplate>
                                    <grid width="40" height="40" verticalalignment="top">
                                        <ellipse fill="black" stroke="white" strokethickness="2" />
                                        <textblock text="{binding id}" foreground="white" fontweight="bold" horizontalalignment="center" verticalalignment="center" />
                                    </grid>
                                    </datatemplate>
                                </controls:datagridtemplatecolumn.celltemplate>-->
                            <controls:DataGridTextColumn Binding="{Binding StorageLocation.StorageName, Mode=TwoWay}" Header="Lagerort"/>
                            <controls:DataGridTextColumn Binding="{Binding Comment, Mode=TwoWay}" Header="Comment"/>
                            <!--<controls:datagridtemplatecolumn header="standort" tag="storagelocation">
                                <controls:datagridtemplatecolumn.celltemplate>
                                    <datatemplate>
                                        <expander 
                                            isexpanded="false"
                                            header="{binding storagelocation, mode=TwoWay}" 
                                            content="{binding transfercomment, mode=TwoWay}"/>
                                    </datatemplate>
                                </controls:datagridtemplatecolumn.celltemplate>
                            </controls:datagridtemplatecolumn>-->
                            <controls:DataGridTextColumn Header="Created" Binding="{Binding CreatedDate, Mode=TwoWay}" Tag="Created" />
                            <controls:DataGridTextColumn Header="Noted By" Binding="{Binding NotedBy, Mode=TwoWay}" Tag="User" />
                        </controls:DataGrid.Columns>
                    </controls:DataGrid>
                </Grid>





                <TextBlock
                Margin="0,20,0,0"
                FontWeight="Bold"
                FontSize="20"
                FontStyle="Normal"
                Text="Umlauf-Historie"/>
                <StackPanel Margin="0,20,0,0" Orientation="Horizontal">
                <Grid Width="40" Height="40" VerticalAlignment="Top">
                    <Ellipse Fill="Black" Stroke="White" StrokeThickness="2" />
                    <TextBlock Text="1" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Grid>
                <Expander
				Margin="10,0,0,0"
				IsExpanded="True"
				ExpandDirection="Down"
				VerticalAlignment="Top"
				HorizontalAlignment="Stretch"
				HorizontalContentAlignment="Stretch"
				Width="600"
				Header="PVB-Labor"
				Content="Anmerkung: kann Fehler nicht nachvollziehen"/>
            </StackPanel>
            <StackPanel Margin="0,20,0,0" Orientation="Horizontal">
                <Grid Width="40" Height="40" VerticalAlignment="Top">
                    <Ellipse Fill="Gray" Stroke="White" StrokeThickness="2" />
                    <TextBlock Text="2" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Grid>
                <Expander
				Margin="10,0,0,0"
				IsExpanded="True"
				ExpandDirection="Down"
				VerticalAlignment="Top"
				HorizontalAlignment="Stretch"
				HorizontalContentAlignment="Stretch"
				Width="600"
				Header="PVB-Labor"
				Content="Anmerkung: kann Fehler nicht nachvollziehen"/>
            </StackPanel>
        
        </StackPanel>


        <!-- Weitergabe- & Anmerkungs-Buttons -->
		<StackPanel
			Grid.Column="2"
			Grid.Row="2"
            Grid.RowSpan="2"
			Margin="0,120,15,0"
			Orientation="Vertical"
            ScrollViewer.VerticalScrollMode="Disabled">
            <Button
				HorizontalAlignment="Right"
				Height="60" Width="250"
				Style="{StaticResource AccentButtonStyle}"
				FontWeight="Bold">Weitergeben</Button>
            <Button
				Margin="0,15,0,0"
				HorizontalAlignment="Right"
				Height="60"
				Width="250">Anmerkung hinzufügen</Button>
        </StackPanel>

        <!-- Status & Info-Panel -->
        <StackPanel
			Grid.Column="2"
			Grid.Row="0"
			Grid.RowSpan="2"
			Margin="0,0,0,0"
			Orientation="Vertical"
            ScrollViewer.VerticalScrollMode="Disabled"
            Background="White"
            Height="250" Width="280">
                <StackPanel
                    Orientation="Horizontal">
                    <TextBlock Margin="20,20,0,0" Text="Status:"/>
                    <TextBlock Margin="20,20,0,0" FontWeight="Bold" 
                        Text="{Binding Status}"/>
                </StackPanel>
                <StackPanel
                    Orientation="Horizontal">
                    <TextBlock Margin="20,20,0,0" Text="im Umlauf seit:"/>
                </StackPanel>
                <StackPanel
                    Orientation="Horizontal">
                    <TextBlock Margin="20,20,0,0" Text="aktueller Standort:"/>
                    <TextBlock Margin="20,20,0,0" FontWeight="Bold" 
                               Text="{Binding Storage}"/>
                </StackPanel>
                <StackPanel
                    Orientation="Horizontal">
                    <TextBlock Margin="20,20,0,0" Text="Verweildauer:"/>
                </StackPanel>
                <StackPanel
                    Orientation="Horizontal">
                    <TextBlock Margin="20,20,0,0" Text="letzte Bearbeitung:"/>
                </StackPanel>
            </StackPanel>
            <!--<Rectangle
				Fill="White" Stroke="LightGray" StrokeThickness="0.5"
				Height="250" Width="280"
				RadiusX="4" RadiusY="4"
				HorizontalAlignment="Right"/>
            <Rectangle
				Fill="White" Stroke="LightGray" StrokeThickness="0.5"
				Height="100" Width="280"
				RadiusX="4" RadiusY="4"
				Margin="0,20,0,0"
				HorizontalAlignment="Right"/>-->

        <!--<ContentControl  ContentTemplate="{StaticResource TransfersPage}"/>-->

            <StackPanel>
                <TextBlock Margin="5,0,0,0" FontWeight="Bold" FontSize="18"
						   Text="{x:Bind Path=ViewModel.SerialNumber, Mode=TwoWay}"/>
                <TextBlock Margin="20,20,0,0" FontWeight="Bold" 
                        Text="{Binding Status}"/>
                <TextBlock Margin="20,20,0,0" FontWeight="Bold" 
                               Text="{Binding Storage}"/>
            </StackPanel>   
            
    </Grid>

    </ScrollViewer>

</Page>